-- Huntress Blink Invulnerability v1.0.4
-- Klehrik

log.info("Successfully loaded ".._ENV["!guid"]..".")
mods.on_all_mods_loaded(function() for k, v in pairs(mods) do if type(v) == "table" and v.hfuncs then Helper = v end end end)

local player = nil
local immune_frames = 15



-- ========== Main ==========

gm.pre_script_hook(gm.constants.__input_system_tick, function()
    if not Helper.instance_exists(player) then player = Helper.get_client_player() end
end)


gm.pre_script_hook(gm.constants.skill_activate, function(self, other, result, args)
    -- Give 15 frames of invincibility on Blink
    if self == player and args[1].value == 2.0 then
        if self.class == 1.0 and self.skills[3].active_skill.name == "skill.huntressC.name" then
            player.invincible = math.max(player.invincible, immune_frames)
        end
    end
end)